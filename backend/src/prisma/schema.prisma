// Schema Prisma para Portal Nitro de Implantação Microsoft 365
// Ajuste a variável DATABASE_URL em .env para apontar para o PostgreSQL

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Projeto {
  id                 Int                  @id @default(autoincrement())
  empresa            String
  inicio             DateTime
  fim                DateTime
  status             String
  percentualConcluido Int
  funcionalidades    Funcionalidade[]
  usuarios           Usuario[]
  emailConfig        EmailConfig?
  sharepointSites    SharePointSite[]
  teamsConfig        TeamsConfig?
  teamsCriadas       TeamsCriada[]
  cronograma         CronogramaEtapa[]
  licenciamento      Licenciamento[]
  mapasAcesso        MapaAcesso[]
  orientacoes        Orientacao[]
  createdAt          DateTime            @default(now())
  updatedAt          DateTime            @updatedAt
}

model Funcionalidade {
  id          Int      @id @default(autoincrement())
  nome        String
  categoria   String
  criticidade String
  tempoEstimadoSemanas Int
  selecionado Boolean  @default(false)
  observacoes String?
  projetoId   Int
  projeto     Projeto  @relation(fields: [projetoId], references: [id])
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Usuario {
  id             Int      @id @default(autoincrement())
  nome           String
  departamento   String
  cargo          String
  email          String   @unique
  tamanhoCaixaGb Float
  officeLocal    Boolean  @default(false)
  migrarEmail    Boolean  @default(true)
  oneDrive       Boolean  @default(true)
  sharePoint     Boolean  @default(true)
  teams          Boolean  @default(true)
  projetoId      Int
  projeto        Projeto  @relation(fields: [projetoId], references: [id])
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
}

model EmailConfig {
  id               Int      @id @default(autoincrement())
  plataformaOrigem String
  metodologia      String
  janelaPreferida  String
  volumeTotalGb    Float
  componentes      String[]
  caixasCompartilhadas Int
  gruposDistribuicao  Int
  observacoes      String?
  projetoId        Int   @unique
  projeto          Projeto @relation(fields: [projetoId], references: [id])
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
}

model SharePointSite {
  id            Int      @id @default(autoincrement())
  tipo          String
  nome          String
  proposito     String
  proprietarios String[]
  membros       String[]
  nivel         String
  volumeDadosGb Float
  pastaOrigem   String?
  recomendacoes String?
  projetoId     Int
  projeto       Projeto @relation(fields: [projetoId], references: [id])
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

model TeamsConfig {
  id         Int     @id @default(autoincrement())
  nomenclatura String
  limites      String
  governanca   String
  backups      String
  seguranca    String
  projetoId   Int   @unique
  projeto     Projeto @relation(fields: [projetoId], references: [id])
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model TeamsCriada {
  id           Int     @id @default(autoincrement())
  nome         String
  tipo         String
  proposito    String
  proprietarios String[]
  membros      String[]
  canais       String[]
  recursos     String[]
  observacoes  String?
  projetoId    Int
  projeto      Projeto @relation(fields: [projetoId], references: [id])
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model CronogramaEtapa {
  id          Int     @id @default(autoincrement())
  nome        String
  responsavel String
  inicio      DateTime
  fim         DateTime
  duracaoDias Int
  status      String
  projetoId   Int
  projeto     Projeto @relation(fields: [projetoId], references: [id])
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Licenciamento {
  id        Int     @id @default(autoincrement())
  tipo      String
  quantidade Int
  projetoId Int
  projeto   Projeto @relation(fields: [projetoId], references: [id])
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model MapaAcesso {
  id        Int     @id @default(autoincrement())
  recurso   String
  acesso    String
  projetoId Int
  projeto   Projeto @relation(fields: [projetoId], references: [id])
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Orientacao {
  id        Int     @id @default(autoincrement())
  titulo    String
  conteudo  String
  projetoId Int
  projeto   Projeto @relation(fields: [projetoId], references: [id])
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
